<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no, width=device-width">
    <title></title>
    <script>
      function animationOut(i) { }
      function animationIn(i) { }
    //well, you need modify the cubeTransition.js file
    //delete the two functions if you dont need this kind of animation.
    </script>
    <script src="lib/jquery-3.2.1.min.js"></script>
    <script src="lib/jquery.cloud9carousel.js"></script>
    <script src='lib/wheel-indicator.js'></script>
    <script src="lib/jquery.touchSwipe.js"></script>
    <script src="lib/cubeTransition.js"></script>
    
    <script src="lib/cp.js"></script>
    <script>
    window.addEventListener('load', function () {
        var intervalCarousel = setInterval(function () {
          console.count()
          var carousels = document.querySelectorAll('div.carousel.height-50p');
          if(carousels.length > 0){
            clearInterval(intervalCarousel)
            for (var i = 0; i < carousels.length; i++) {
              if (window.CP.shouldStopExecution(1)) {
                break;
              }
              carousel(carousels[i],'carousel');
            }
            window.CP.exitedLoop(1);
          }
         }, 500);
        var intervalCarousel1 = setInterval(function () {
          console.count()
          var carousels2 = document.querySelectorAll('div.carousel.h-5');
          if(carousels2.length > 0){
            clearInterval(intervalCarousel1)
            for (var i = 0; i < carousels2.length; i++) {
              if (window.CP.shouldStopExecution(1)) {
                break;
                  }
              carousel(carousels2[i],'carousels2');
            }
            window.CP.exitedLoop(1);
          }
         }, 500);
        

      });

      function carousel(root,name) {
        console.log(root,name)
        window.CP[name]= {};
        var figure = root.querySelector('figure'),
          nav = root.querySelector('nav'),
          images = figure.children,
          n = images.length,
          gap = root.dataset.gap || 0,
          bfc = 'bfc' in root.dataset,
          theta = 2 * Math.PI / n,
          currImage = 0;

        setupCarousel(n, parseFloat(getComputedStyle(images[0]).width));
        window.addEventListener('resize', function () {
          setupCarousel(n, parseFloat(getComputedStyle(images[0]).width));
        });

        setupNavigation();

        function setupCarousel(n, s) {
          var apothem = s / (2 * Math.tan(Math.PI / n));

          figure.style.transformOrigin = '50% 50% ' + -apothem + 'px';

          for (var i = 0; i < n; i++) {
            if (window.CP.shouldStopExecution(2)) {
              break;
            }
            images[i].style.padding = gap + 'px';
          }
          window.CP.exitedLoop(2);
          for (i = 1; i < n; i++) {
            if (window.CP.shouldStopExecution(3)) {
              break;
            }
            images[i].style.transformOrigin = '50% 50% ' + -apothem + 'px';
            images[i].style.transform = 'rotateY( ' + i * theta + 'rad)';
          }
          window.CP.exitedLoop(3);

          if (bfc)
            for (i = 0; i < n; i++) {
              if (window.CP.shouldStopExecution(4)) {
                break;
              }
              images[i].style.backfaceVisibility = 'hidden';
            }
          window.CP.exitedLoop(4);
          rotateCarousel(currImage);
        }
        window.CP[name].nextSwipe = function () {
          rotateCarousel(++currImage);
        }
        window.CP[name].previousSwipe = function () {
          rotateCarousel(--currImage);
        }
        function setupNavigation() {
          nav.addEventListener('click', onClick, true);

          function onClick(e) {
            e.stopPropagation();
            console.log('logged click')
            var t = e.target;
            if (t.tagName.toUpperCase() != 'BUTTON') return;

            if (t.classList.contains('next')) {
              console.log('logged next ckick')
              currImage++;
            } else {
              currImage--;
            }

            rotateCarousel(currImage);
          }
        }
        window.CP[name].drag = function (x) {
          // console.log(window.innerWidth,x, x-window.innerWidth,currImage)
          figure.style.transform = 'rotateY(' + (x-window.innerWidth)/(window.innerWidth/(2*Math.sin(Math.PI/n)))  +(currImage * -theta)+ 'rad)';
        }
        function rotateCarousel(imageIndex) {
          figure.style.transform = 'rotateY(' + imageIndex * -theta + 'rad)';
        }
      }</script>
    <link rel="manifest" href="manifest.json">
    <!-- <link rel="stylesheet" href="lib/swiper/dist/css/swiper.css"> -->
    <link rel="stylesheet" href="lib/swiper/dist/css/swiper.min.css">
    
    <!-- <script src="lib/swiper/dist/js/swiper.js"></script> -->
    <script src="lib/swiper/dist/js/swiper.min.js"></script>
    <!-- <script src="lib/swiper/dist/js/swiper.esm.js"></script> -->
    <!-- <script src="lib/swiper/dist/js/swiper.esm.bundle.js"></script> -->

    <!-- un-comment this code to enable service worker
    <script>
      if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('service-worker.js')
          .then(() => console.log('service worker installed'))
          .catch(err => console.log('Error', err));
      }
    </script>-->

    <link href="lib/ionic/css/ionic.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">

    <!-- IF using Sass (run gulp sass first), then uncomment below and remove the CSS includes above
    -->
    <link href="css/ionic.app.css" rel="stylesheet">

    <!-- ionic/angularjs js -->
    <script src="lib/ionic/js/ionic.bundle.js"></script>
    <script src="lib/lodash.min.js"></script>

    <!-- cordova script (this will be a 404 during development) -->
    <script src="cordova.js"></script>

    <!-- your app's js -->
    <script src="js/app.js"></script>
    <script src="js/controllers.js"></script>
  </head>

  <body ng-app="starter">
    <ion-nav-view ></ion-nav-view>
  </body>
</html>
